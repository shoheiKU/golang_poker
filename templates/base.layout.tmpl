{{define "base"}}
    <!DOCTYPE html>
    <html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
                integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l"
                crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="https://unpkg.com/notie/dist/notie.min.css">
        <script src="https://unpkg.com/notie"></script>
        <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
        <style type="text/css">
            div.content {
                padding: 0px 5px 10px 5px;
            }
            div img {
                margin:15px;
            }
            @media screen and (max-width: 479px) { /*window size is less than 479*/
                #table img {
                    width: 120;
                }
            }

            div.bettingbuttons, div.buttons {
                padding: 5px 0px 5px 0px;
            }

            div.betsuccess {
                background: lightgreen;
                position: fixed;
                top: 60px;
                right: 30px;
                border: solid;
                border-radius: 8px;
                font-size: 36px;
                height: 50px;
                box-sizing: content-box;
            }

            div.centering {
                height: 100%;
                box-sizing: content-box;
                margin: auto;
            }

        </style>
        <title>
            {{block "title" .}}

            {{end}}
        </title>
        {{block "css" .}}

        {{end}}
    </head>

    <body>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <a class="navbar-brand" href="/">Poker</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/" id="home">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/about" id="about">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/poker" id="poker">Poker</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/mobilepoker" id="mobile">Mobile Poker</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/remotepoker" id="remote">Remote Poker</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/contact" id="contact">Contact</a>
                    </li>

                </ul>
            </div>
        </nav>

        <div class="content">
        {{block "content" .}}

        {{end}}
        </div>


        <script>
            function popup(type, title, text){
                Swal.fire({
                    icon: type,
                    title: title,
                    text: text,
                })
            }

            function temppopup(type, title, text, pos, sec){
                Swal.fire({
                    icon: type,
                    title: title,
                    text: text,
                    showConfirmButton: false,
                    timer: sec*1000,
                    position: pos,
                })
            }
            {{with .Flash}}
                popup("success", "Success", "{{.}}")
            {{end}}
            {{with .Warning}}
                popup("warning", "Warning", "{{.}}")
            {{end}}
            {{with .Error}}
                popup("error", "Error", "{{.}}")
            {{end}}
            {{with .Info}}
                popup("info", "Info", "{{.}}")
            {{end}}
            {{with .NotieFlash}}
                notie.alert({type: "success", text: "{{.}}", stay: true})
            {{end}}
            {{with .NotieWarning}}
                notie.alert({type: "warning", text: "{{.}}", stay: true})
            {{end}}
            {{with .NotieError}}
                notie.alert({type: "error", text: "{{.}}", stay: true})
            {{end}}
            {{with .NotieInfo}}
                notie.alert({type: "info", text: "{{.}}", stay: true})
            {{end}}

        </script>
        
        <!-- {{block "mobilepoker" .}} -->
            <script>
                function stopAjax(jqXHRWBD, jqXHRWT){
                    jqXHRWBD.abort();
                    jqXHRWT.abort();
                    document.betform.submit()
                }

                function mobileWaitingTurn(jqXHRWT, jqXHRWBD){
                    jqXHRWT = $.ajax({
                    url: '/ajax/waitingturn',
                    dataType: 'json',
                    success: async function(data) {
                        console.log("mobileWaitingTurn")
                        switch (data["func"]) {
                            case "prefrop":
                                // Prefrop
                                notie.alert({ type: 'info', text: data["text"], stay: true})
                                break;
                            case "frop":
                                // Frop
                                notie.alert({ type: 'info', text: data["text"], stay: true})
                                frop(data["cards"]);
                                break;
                            case "turn":
                                // Turn
                                notie.alert({ type: 'info', text: data["text"], stay: true})
                                turn(data["card"]);
                                break;
                            case "river":
                                // River
                                notie.alert({ type: 'info', text: data["text"], stay: true})
                                river(data["card"]);
                                break;
                            case "result":
                                // Result
                                notie.alert({ type: 'info', text: data["text"], stay: true})
                                // Pop Up
                                Swal.fire({
                                    icon:"info",
                                    title:"Info",
                                    text: "Show Down",
                                    confirmButtonText:'<a href=' + data["URL"] + ' style="text-decoration:none; color:white; font-size:large; font-weight: bold;">Show Down</a>'
                                });
                                break;
                            case "reset":
                                // Reset
                                console.log(jqXHRWBD)
                                stopAjax(jqXHRWBD, jqXHRWT)
                                document.location.href = data["redirect"];
                                break;
                            case "popup":
                                // Pop Up
                                Swal.fire({
                                    icon:"error",
                                    title:"Something went wrong!",
                                    text: "Please click OK",
                                    confirmButtonText:'<a href="/remotepoker" style="text-decoration:none; color:white; font-size:large; font-weight: bold;">OK</a>'
                                });
                                break;
                        }
                        mobileWaitingTurn();
                    },
                    });
                    return jqXHRWT
                }

                function mobileWaitingBetData(jqXHRWBD, player, nowPlayer){
                    console.log("mobileWaitingBetData")
                    jqXHRWBD = $.ajax({
                    url: '/ajax/waitingpokerdata',
                    dataType: 'json',
                    success: function(data) {
                        console.log(data)
                        nowPlayer = data["decisionMaker"]
                        $('#decisionMaker').text(nowPlayer)
                        $('#betSize').text(data["betSize"]);
                        $('#originalRaiser').text(data["originalRaiser"]);
                        if (player === nowPlayer) {
                            text = data["originalRaiser"] + " bet " + data["betSize"] + " dollars"
                            popup("info", "Your Turn", text)
                        } else {
                            text = nowPlayer + " is playing"
                            temppopup("info", "Info", text, "center", 1)
                        }
                        mobileWaitingBetData(jqXHRWBD, player, nowPlayer)
                    },
                    });
                    return jqXHRWBD;
                }
            </script>
        <!-- {{end}} -->
        <!-- {{block "poker" .}} -->
            <script>
                function frop(cards){
                    $.each(cards, function(index, card){
                        //カードを裏の画像から表の画像に切り替える
                        $("#CommunityCard" + String(index)).attr('src', "/static/cardsIMG/" + card.Num + "_of_" + card.Suit + ".png");
                    })
                };
                function turn(card){
                    //カードを裏の画像から表の画像に切り替える
                    $("#CommunityCard3").attr('src', "/static/cardsIMG/" + card.Num + "_of_" + card.Suit + ".png");
                };
                function river(card){
                    //カードを裏の画像から表の画像に切り替える
                    $("#CommunityCard4").attr('src', "/static/cardsIMG/" + card.Num + "_of_" + card.Suit + ".png");
                };
                function navResult(url){
                    // Pop Up
                    Swal.fire({
                        icon:"info",
                        title:"Result",
                        text: "Show Down",
                        confirmButtonText:'<a href=' + url + ' style="text-decoration:none; color:white; font-size:large; font-weight: bold;">Result page</a>'
                    });
                };
                function waitingPhase(jqXHR) {
                    console.log("mobileWaitingPhase")
                    jqXHR = $.ajax({
                    url: '/ajax/waitingphase',
                    dataType: 'json',
                    success: function(data) {
                        console.log(data)
                        switch (data["function"]){
                            case "frop":
                                popup("info", "Info", "Frop Phase")
                                frop(data["cards"]);
                                break;
                            case "turn":
                                popup("info", "Info", "Turn Phase")
                                turn(data["card"]);
                                break;
                            case "river":
                                popup("info", "Info", "River Phase")
                                river(data["card"]);
                                break
                            case "result":
                                navResult(data["URL"]);
                                break;
                        }
                        waitingPhase(jqXHR)
                    },
                    });
                    return jqXHR
                };
            </script>

        <!-- {{end}} -->
        {{block "js" .}}

        {{end}}
    </body>

    </html>
{{end}}